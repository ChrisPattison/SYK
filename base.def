Bootstrap: docker
From: fedora:31

%runscript

%files

%environment
export PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=cpp

%labels

%post
dnf install -y cmake git g++ wget gdb
dnf install -y make bzip2 autoconf automake libtool curl make unzip
dnf install -y python3 python3-devel
dnf install -y eigen3-devel

# Protobuf build
PROTOBUF_VER=3.10.1
wget https://github.com/protocolbuffers/protobuf/releases/download/v${PROTOBUF_VER}/protobuf-cpp-${PROTOBUF_VER}.tar.gz
tar -xzf protobuf-cpp-${PROTOBUF_VER}.tar.gz
cd protobuf-${PROTOBUF_VER}
./configure --prefix=/usr
make -j$(nproc)
make check
make install
ldconfig

PROTOCOL_BUFFERS_PYTHON_IMPLEMENTATION=cpp
python3 -m venv /python
source /python/bin/activate
pip install matplotlib numpy scipy pandas numba pathos
pip install protobuf --install-option="--cpp_implementation" 

